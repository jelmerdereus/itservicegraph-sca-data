{
  "title": "DevSecOps & Vulnerability Management",
  "version": "2.4",
  "settings": {
    "pagenumber": 1,
    "editable": true,
    "fullscreenEnabled": false,
    "parameters": {
      "neodash_swName_Snapshot": "Bytecard",
      "neodash_snapshot_type": "SCA",
      "neodash_sw_component": "jetty-server",
      "neodash_softwarecomponent_component": "django",
      "neodash_softwarecomponent_component_display": "django",
      "neodash_another_variable ": "Bytecard",
      "neodash_selected_app": "Zoolab"
    },
    "theme": "light"
  },
  "pages": [
    {
      "title": "Overview",
      "reports": [
        {
          "id": "8fec8afb-fb44-4f96-9619-7d341c4568e6",
          "title": "Number of Applications",
          "query": "MATCH (sw:Software) RETURN count(sw) AS nr_software_installed\n\n\n\n",
          "width": 8,
          "height": 3,
          "x": 0,
          "y": 0,
          "type": "value",
          "selection": {},
          "settings": {
            "textAlign": "center",
            "verticalAlign": "middle",
            "description": "Number of running applications for customer services",
            "fontSize": 96
          },
          "schema": []
        },
        {
          "id": "ce9256da-2a94-4dc2-898f-651a5512c326",
          "title": "Number of SCA analyses",
          "query": "MATCH p = (sn:Snapshot)-[]-(sw:Software)\nRETURN count(p)",
          "width": 7,
          "height": 3,
          "x": 8,
          "y": 0,
          "type": "value",
          "selection": {},
          "settings": {
            "description": "Number of applications that have produced an SBOM and that have been scanned using Software Composition Analysis",
            "fontSize": 96,
            "textAlign": "center",
            "verticalAlign": "middle"
          },
          "schema": []
        },
        {
          "id": "5203777d-faf8-4727-9195-d109397d70d1",
          "title": "SCA adoption rate",
          "query": "MATCH (sw:Software)\nOPTIONAL MATCH (sn:Snapshot)-[]-(sw)\nRETURN toFloat(count(sn)) / toFloat(count(sw)) * 100\n\n",
          "width": 11,
          "height": 4,
          "x": 12,
          "y": 3,
          "type": "gauge",
          "selection": {},
          "settings": {},
          "schema": []
        },
        {
          "id": "b014e9ec-6efd-4782-9893-1413865d0551",
          "title": "SCA analysis sources",
          "query": "MATCH (vl:Vulnerability)\nRETURN DISTINCT (vl.source) as name\n\n\n\n",
          "width": 11,
          "height": 4,
          "x": 0,
          "y": 3,
          "type": "table",
          "selection": {},
          "settings": {}
        },
        {
          "id": "a502a53a-555b-4cb3-84b3-e5fd3bb6f6d2",
          "title": "Vulnerabilities detected - Distribution of Severities",
          "query": "MATCH (sc:SoftwareComponent)-[]-(sn:Snapshot)-[]-(sw:Software)\nMATCH (vl:Vulnerability)-[]-(sc)\nRETURN DISTINCT vl.severity AS Severity, count(vl) as Vulnerabilities ORDER BY Severity;\n\n\n",
          "width": 23,
          "height": 5,
          "x": 0,
          "y": 7,
          "type": "bar",
          "selection": {
            "index": "Severity",
            "value": "Vulnerabilities",
            "key": "(none)"
          },
          "settings": {
            "marginBottom": 50,
            "barValues": true
          },
          "schema": []
        },
        {
          "id": "be810aea-d256-41f2-9813-bcf816c35544",
          "title": "Number of Vulnerabilities",
          "query": "MATCH (vu:Vulnerability)\nRETURN count(vu);\n\n\n",
          "width": 8,
          "height": 3,
          "x": 15,
          "y": 0,
          "type": "value",
          "selection": {},
          "settings": {
            "verticalAlign": "middle",
            "textAlign": "center",
            "fontSize": 96
          },
          "schema": []
        }
      ]
    },
    {
      "title": "Vulnerabilities high-level",
      "reports": [
        {
          "id": "c9850ef1-7cf1-4de0-8a7c-9f55d944c313",
          "title": "Applications with critical vulnerabilities",
          "query": "MATCH (sw:Software)-[]-(sv:Service)\nMATCH (sc:SoftwareComponent)-[]-(sn:Snapshot)-[r2]-(sw)\nMATCH critical_p = (vl:Vulnerability)-[r3]-(sc) WHERE vl.severity = \"CRITICAL\"\nRETURN DISTINCT count(DISTINCT critical_p) as criticals, sw.swName as application\nORDER BY criticals DESC;\n\n\n\n\n",
          "width": 11,
          "height": 4,
          "x": 0,
          "y": 5,
          "type": "table",
          "selection": {},
          "settings": {
            "actionsRules": [
              {
                "condition": "Click",
                "field": "application",
                "value": "application",
                "customization": "set variable",
                "customizationValue": "selected_app"
              }
            ],
            "columnWidths": "[0.2,0.8]"
          },
          "schema": []
        },
        {
          "id": "b6e6c967-f5ca-400b-90e8-b326455d5e8d",
          "title": "Business owners",
          "query": "MATCH (sw:Software {swName: $neodash_selected_app})\nRETURN DISTINCT sw.swOwner as `Business Owner`;",
          "width": 11,
          "height": 4,
          "x": 11,
          "y": 5,
          "type": "table",
          "selection": {},
          "settings": {}
        },
        {
          "id": "bbbbc9f1-7079-46d7-a32c-b0f0189e25a5",
          "title": "Vulnerability States",
          "query": "MATCH (sc:SoftwareComponent)-[]-(sn:Snapshot)-[]-(sw:Software)\nMATCH (vl:Vulnerability)-[]-(sc)\nRETURN DISTINCT vl.status AS Status, count(vl) as states, vl.severity AS Severity\n\n\n",
          "width": 22,
          "height": 5,
          "x": 0,
          "y": 0,
          "type": "bar",
          "selection": {
            "index": "Status",
            "value": "states",
            "key": "Severity"
          },
          "settings": {
            "valueScale": "linear",
            "barValues": true,
            "positionLabel": "off",
            "marginBottom": 50,
            "showOptionalSelections": true,
            "layout": "vertical",
            "groupMode": "grouped",
            "colors": "accent",
            "customDimensions": false,
            "innerPadding": 5
          },
          "schema": []
        },
        {
          "id": "7f8c872d-db0c-4a72-aa99-fc688588980f",
          "title": "Software Structure and Vulnerabilities associated",
          "query": "MATCH p=(sw:Software {swName: $neodash_selected_app})<-[]-(:Snapshot)<-[]-(:SoftwareComponent)<-[]-(vl:Vulnerability) WHERE vl.severity = \"CRITICAL\"\nRETURN p\n\n",
          "width": 22,
          "height": 9,
          "x": 0,
          "y": 9,
          "type": "graph",
          "selection": {
            "Software": "(label)",
            "Snapshot": "(label)",
            "SoftwareComponent": "(label)",
            "Vulnerability": "title"
          },
          "settings": {
            "layout": "force-directed"
          },
          "schema": [
            [
              "Software",
              "swName",
              "swOwner",
              "swVersion",
              "swFirstSeen",
              "swVendor",
              "swLastUpdated"
            ],
            [
              "Snapshot",
              "date",
              "ref",
              "type"
            ],
            [
              "SoftwareComponent",
              "component",
              "purl",
              "version"
            ],
            [
              "Vulnerability",
              "severity",
              "fixed_version",
              "vulnerability_id",
              "link",
              "source",
              "published",
              "title",
              "status"
            ]
          ]
        },
        {
          "id": "6b629d3a-e84d-42f2-b9eb-cb944888357a",
          "title": "",
          "query": "MATCH (sc:SoftwareComponent)-[]-(sn:Snapshot)-[]-(sw:Software)\nMATCH (vl:Vulnerability)-[]-(sc)\nRETURN DISTINCT vl.status AS Status, vl.severity AS Severity, count(vl) as states ORDER BY Status;\n\n\n",
          "width": 22,
          "height": 6,
          "x": 0,
          "y": 18,
          "type": "table",
          "selection": {},
          "settings": {},
          "schema": []
        }
      ]
    },
    {
      "title": "Drill Down",
      "reports": [
        {
          "id": "06075f52-0723-439b-848e-7c38861c8136",
          "title": "Installed Software",
          "query": "MATCH(sw:Software)<-[:SNAPSHOT_OF]-(:Snapshot)\nRETURN sw.swName AS SoftwareName;\n\n\n",
          "width": 8,
          "height": 6,
          "x": 0,
          "y": 0,
          "type": "table",
          "selection": {},
          "settings": {
            "actionsRules": [
              {
                "condition": "Click",
                "field": "SoftwareName",
                "value": "SoftwareName",
                "customization": "set variable",
                "customizationValue": "swName_Snapshot"
              },
              {
                "condition": "Click",
                "field": "SoftwareName",
                "value": "",
                "customization": "set variable",
                "customizationValue": "another_variable "
              }
            ]
          }
        },
        {
          "id": "9635407d-102d-4083-9088-e5100acd88a9",
          "title": "Snapshots of software $neodash_swName_Snapshot",
          "query": "MATCH(sw:Software {swName: $neodash_swName_Snapshot})<-[:SNAPSHOT_OF]-(sn:Snapshot)\nRETURN sn.type AS SnapshotType;\n\n\n\n",
          "width": 6,
          "height": 6,
          "x": 8,
          "y": 0,
          "type": "table",
          "selection": {},
          "settings": {
            "actionsRules": [
              {
                "condition": "Click",
                "field": "SnapshotType",
                "value": "SnapshotType",
                "customization": "set variable",
                "customizationValue": "snapshot_type"
              }
            ]
          }
        },
        {
          "id": "8dc2252a-cd53-40f0-990f-9377e5bacea4",
          "title": "Vulnerable Components in $neodash_snapshot_type analysis",
          "query": "MATCH (sw:Software {swName: $neodash_swName_Snapshot})<-[:SNAPSHOT_OF]-(sn:Snapshot {type: $neodash_snapshot_type})<-[:IDENTIFIED_IN]-(sc:SoftwareComponent)\nMATCH (sc)-[vo:VULNERABILITY_OF]-(vl:Vulnerability)\nRETURN DISTINCT sc.component AS Component, sc.version AS Version",
          "width": 9,
          "height": 6,
          "x": 14,
          "y": 0,
          "type": "table",
          "selection": {},
          "settings": {
            "actionsRules": [
              {
                "condition": "Click",
                "field": "Component",
                "value": "Component",
                "customization": "set variable",
                "customizationValue": "sw_component"
              }
            ],
            "columnWidths": "[0.5,0.2,0.2]"
          }
        },
        {
          "id": "544acdb1-e1a4-422f-92be-6c95cad2e01b",
          "title": "Known Vulnerabilities for $neodash_sw_component",
          "query": "OPTIONAL MATCH (sw:Software {swName: $neodash_swName_Snapshot})<-[:SNAPSHOT_OF]-(sn:Snapshot {type: $neodash_snapshot_type})<-[:IDENTIFIED_IN]-(sc:SoftwareComponent {component: $neodash_sw_component})-[:VULNERABILITY_OF]-(vu:Vulnerability)\nRETURN vu.vulnerability_id as cve_id, vu.severity as severity, vu.status as status, vu.fixed_version as fixed_version, vu.link as more_info;\n\n\n\n",
          "width": 23,
          "height": 4,
          "x": 0,
          "y": 6,
          "type": "table",
          "selection": {},
          "settings": {
            "columnWidths": "[0.2,0.1,0.1,0.1,0.5]"
          }
        },
        {
          "id": "5e4e9653-7408-4d8b-9c27-5a1eaa545670",
          "title": "Services Affected by Vulerabilities",
          "query": "OPTIONAL MATCH (sv:Service)<-[:DELIVERS]-(sw:Software {swName: $neodash_swName_Snapshot})<-[:SNAPSHOT_OF]-(sn:Snapshot {type: $neodash_snapshot_type})<-[:IDENTIFIED_IN]-(sc:SoftwareComponent {component: $neodash_sw_component})-[:VULNERABILITY_OF]-(vu:Vulnerability)\nRETURN sv.serviceName AS Service, sv.serviceSLA as SLA, vu.vulnerability_id as cve_id, vu.severity as Severity, vu.status as Status, vu.fixed_version as `Fixed Version`\nORDER BY SLA DESC, Severity;\n\n\n\n",
          "width": 23,
          "height": 6,
          "x": 0,
          "y": 10,
          "type": "table",
          "selection": {},
          "settings": {
            "styleRules": [
              {
                "field": "Status",
                "condition": "=",
                "value": "fixed",
                "customization": "cell color",
                "customizationValue": "#5AEF5A"
              },
              {
                "field": "Status",
                "condition": "!=",
                "value": "fixed",
                "customization": "row color",
                "customizationValue": "orange"
              }
            ]
          }
        }
      ]
    },
    {
      "title": "Search based Analysis",
      "reports": [
        {
          "id": "d2fb639c-d395-4ce0-a129-7b2374feb88a",
          "title": "Search for SW Component",
          "query": "MATCH (n:`SoftwareComponent`) \nWHERE toLower(toString(n.`component`)) CONTAINS toLower($input) \nRETURN DISTINCT n.`component` as value,  n.`component` as display ORDER BY size(toString(value)) ASC LIMIT 5",
          "width": 8,
          "height": 4,
          "x": 0,
          "y": 0,
          "type": "select",
          "selection": {},
          "settings": {
            "type": "Node Property",
            "entityType": "SoftwareComponent",
            "propertyType": "component",
            "propertyTypeDisplay": "component",
            "parameterName": "neodash_softwarecomponent_component"
          },
          "schema": []
        },
        {
          "id": "a1761ad8-bb5b-405e-b0ec-6b6b69195550",
          "title": "found vulnerable components",
          "query": "\nMATCH (sw:Software)<-[:SNAPSHOT_OF]-(sn:Snapshot)<-[:IDENTIFIED_IN]-(sc:SoftwareComponent {component: $neodash_softwarecomponent_component})\nMATCH (sc)-[vo:VULNERABILITY_OF]-(vl:Vulnerability)\nRETURN DISTINCT sc.component AS Component, sc.version AS Version, sc.purl AS PURL;\n\n",
          "width": 14,
          "height": 4,
          "x": 8,
          "y": 0,
          "type": "table",
          "selection": {},
          "settings": {}
        },
        {
          "id": "25e18614-1ea7-481a-8d4a-098f0ae02aca",
          "title": "Found vulnerable Application-Services",
          "query": "MATCH (sv:Service)\nMATCH (sv)-[]-(sw:Software)<-[:SNAPSHOT_OF]-(sn:Snapshot)<-[:IDENTIFIED_IN]-(sc:SoftwareComponent {component: $neodash_softwarecomponent_component})\nMATCH (sc)-[vo:VULNERABILITY_OF]-(vl:Vulnerability)\nRETURN  DISTINCT sv.serviceName as Service, sw.swName as Application, sv.serviceOwner as `Service Owner`\nORDER BY sw.swName\n\n\n\n",
          "width": 22,
          "height": 5,
          "x": 0,
          "y": 4,
          "type": "table",
          "selection": {},
          "settings": {}
        },
        {
          "id": "92ad2d44-e67b-4109-8352-cd37cff93d10",
          "title": "Customers affected in case of critical Vulnerabilities",
          "query": "MATCH (cu:Customer)<-[:CONSUMED_BY]-(sv:Service)<-[:DELIVERS]-(sw:Software)<-[:SNAPSHOT_OF]-(sn:Snapshot)<-[:IDENTIFIED_IN]-(sc:SoftwareComponent {component: $neodash_softwarecomponent_component})<-[:VULNERABILITY_OF]-(vl:Vulnerability)\nRETURN  DISTINCT sv.serviceName as Service, sv.serviceOwner as `Service Owner`, cu.customerName AS Customer, cu.customerImportance AS `Customer Importance`\nORDER BY `Customer Importance` DESC;\n\n\n",
          "width": 22,
          "height": 4,
          "x": 0,
          "y": 9,
          "type": "table",
          "selection": {},
          "settings": {
            "styleRules": [
              {
                "field": "Customer Importance",
                "condition": "=",
                "value": "9",
                "customization": "cell color",
                "customizationValue": "#FA0505"
              },
              {
                "field": "Customer Importance",
                "condition": ">=",
                "value": "7",
                "customization": "cell color",
                "customizationValue": "orange"
              },
              {
                "field": "Customer Importance",
                "condition": ">=",
                "value": "4",
                "customization": "cell color",
                "customizationValue": "lightblue"
              }
            ],
            "columnWidths": "[0.3,0.3,0.3,0.1]"
          }
        }
      ]
    }
  ],
  "parameters": {},
  "extensions": {
    "active": true,
    "activeReducers": [],
    "advanced-charts": {
      "active": true
    },
    "styling": {
      "active": true
    },
    "actions": {
      "active": true
    }
  },
  "uuid": "b7f3d9c7-f067-4ae3-b7f2-e2f618946e04"
}